- header:
    model: VX
    nvue-api-version: nvue_v1
    rev-id: 1.0
    version: Cumulus Linux 5.6.0
- set:
    bridge:
      domain:
        br_default:
          vlan:
            '196':
              vni:
                '1025196': {}
            '185':
              vni:
                '1025185': {}
    evpn:
      enable: on
    interface:
      lo:
        ip:
          address:
            10.217.5.39/32: {}
        type: loopback
      pf0dpu1_if:
        ip:
          address:
            169.254.169.253/30: {}
      pf0dpu5_if:
        ip:
          address:
            10.10.10.2/29: {}
      p0_if:
        type: swp
      p1_if:
        type: swp
      pf0vf0_if:
        type: swp
        bridge:
          domain:
            br_default:
              access: 196
        acl:
          p0000_deny_prefixes_ipv4:
            inbound: {}
          drop_dhcp_flood_over_overlay:
            inbound: {}
          p0004_security_policy_override_ipv4_host_ingress:
            outbound: {}
          p0005_security_group_ipv4_in: 
            inbound: {}
          p0005_security_group_ipv6_in:
            inbound: {}
          p0005_security_group_ipv4_out: 
            outbound: {}
          p0005_security_group_ipv6_out: 
            outbound: {}
          p0009_vpc_peer_egress_from_host:
            inbound: {}
          p0009_vpc_peer_ingress_to_host:
            outbound: {}
      vlan196:
        type: svi
        vlan: 196
        ip:
          address:
            10.217.5.169/29: {}
      pf0hpf_if:
        type: swp
        bridge:
          domain:
            br_default:
              access: 185
        acl:
          p0000_deny_prefixes_ipv4:
            inbound: {}
          drop_dhcp_flood_over_overlay:
            inbound: {}
          p0004_security_policy_override_ipv4_host_ingress:
            outbound: {}
          p0005_security_group_ipv4_in: 
            inbound: {}
          p0005_security_group_ipv6_in:
            inbound: {}
          p0005_security_group_ipv4_out: 
            outbound: {}
          p0005_security_group_ipv6_out: 
            outbound: {}
          p0009_vpc_peer_egress_from_host:
            inbound: {}
          p0009_vpc_peer_ingress_to_host:
            outbound: {}
      vlan185:
        type: svi
        vlan: 185
        ip:
          address:
            10.217.5.161/30: {}
    nve:
      vxlan:
        arp-nd-suppress: on
        enable: on
        source:
          address: 10.217.5.39
    router:
      bgp:
        autonomous-system: 4259912557
        enable: on
        router-id: 10.217.5.39
      policy:
        prefix-list:
          FORGE_FROM_UNDERLAY:
            rule:
              '10':
                action: permit
                match:
                  0.0.0.0/0: {}
              '1000':
                action: deny
                match:
                  any: {}
          dpu_from_instance:
            rule:
              '1000':
                action: permit
                match:
                  5.255.255.0/24:
                    min-prefix-len: 32
              '65535':
                action: deny
                match:
                  any: {}
        route-map:
          FORGE_TO_UNDERLAY:
            rule:
              '10':
                action:
                  deny: {}
                match:
                  interface: vlan196
              '20':
                action:
                  deny: {}
                match:
                  interface: vlan185
              '1000':
                action:
                  permit: {}
          dpu_to_instance:
            rule:
              '10':
                action:
                  deny: {}
    system:
      reflexive-acl:
        enable: on
    vrf:
      default:
        router:
          nexthop-tracking:
            ipv4:
              resolved-via-default: on
          static:
            10.255.254.253/32:
              address-family: ipv4-unicast
              via:
                10.10.10.1:
                  type: ipv4-address
            10.217.5.170/32:
              address-family: ipv4-unicast
              via:
                vlan196:
                  type: interface
            10.217.5.162/32:
              address-family: ipv4-unicast
              via:
                vlan185:
                  type: interface
          bgp:
            address-family:
              ipv4-unicast:
                network:
                  10.255.254.253/32: {}
                  10.217.5.39/32: {}
                  10.217.5.170/32: {}
                  10.217.5.162/32: {}
                enable: on
                multipaths:
                  ebgp: 128
                redistribute:
                  connected:
                    enable: on
              l2vpn-evpn:
                enable: on
            enable: on
            neighbor:
              172.43.0.1:
                peer-group: routeserver
                type: numbered
              172.43.0.2:
                peer-group: routeserver
                type: numbered
              p0_if:
                peer-group: underlay
                type: unnumbered
              p1_if:
                peer-group: underlay
                type: unnumbered
              10.217.5.170:
                passive-mode: on
                peer-group: tenant
                type: numbered
              10.217.5.162:
                passive-mode: on
                peer-group: tenant
                type: numbered
              10.10.10.3:
                passive-mode: on
                peer-group: tenant
                type: numbered
            path-selection:
              multipath:
                aspath-ignore: on
            peer-group:
              routeserver:
                address-family:
                  ipv4-unicast:
                    enable: off
                  l2vpn-evpn:
                    aspath:
                      allow-my-asn:
                        enable: on
                    enable: on
                multihop-ttl: 255
                remote-as: external
                update-source: lo
              tenant:
                address-family:
                  ipv4-unicast:
                    policy:
                      inbound:
                        prefix-list: dpu_from_instance
                      outbound:
                        route-map: dpu_to_instance
                nexthop-connected-check: off
                remote-as: 65100
                timers:
                  connection-retry: 10
                  hold: 9
                  keepalive: 3
                  route-advertisement: none
              underlay:
                remote-as: external
                address-family:
                  ipv4-unicast:
                    policy:
                      inbound:
                        prefix-list: FORGE_FROM_UNDERLAY
                      outbound:
                        route-map: FORGE_TO_UNDERLAY
                    aspath:
                      allow-my-asn:
                        enable: on
    acl:
      p0000_deny_prefixes_ipv4:
        type: ipv4
        rule:
          '1001':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 192.0.2.0/24
          '1002':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 198.51.100.0/24
      p0005_security_group_ipv4_in: 
        rule:
          '65535':
            action:
              deny: {}
        type: ipv4
      p0005_security_group_ipv6_in: 
        rule:
          '65535':
            action:
              deny: {}
        type: ipv6
      p0005_security_group_ipv4_out: 
        rule:
          '65532':
            action:
              permit: {}
            match:
              ip:
                protocol: tcp
              conntrack:
                established: {}
          '65533':
            action:
              permit: {}
            match:
              ip:
                protocol: udp
              conntrack:
                established: {}
          '65534':
            action:
              permit: {}
            match:
              ip:
                protocol: icmp
              conntrack:
                established: {}
          '65535':
            action:
              deny: {}
        type: ipv4
      p0005_security_group_ipv6_out: 
        type: ipv6
        rule:
          '65535':
            action:
              deny: {}
      p0009_vpc_peer_egress_from_host:
        type: ipv4
        rule:
          '1':
            action:
              permit: {}
            match:
              ip:
                dest-ip: 10.217.6.176/29
      p0009_vpc_peer_ingress_to_host:
        type: ipv4
        rule:
          '1':
            action:
              permit: {}
            match:
              ip:
                source-ip: 10.217.6.176/29
      drop_dhcp_flood_over_overlay:
        rule:
          '10':
            action:
              deny: {}
            hw-offload: off
            match:
              ip:
                dest-ip: 255.255.255.255
                protocol: udp
                dest-port:
                  '67': {}
                source-port:
                  '68': {}
        type: ipv4
      p0004_security_policy_override_ipv4_host_ingress:
        type: ipv4
        rule:
          '2000':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 7.7.7.0/24
                dest-port:
                  '80': {} 
                protocol: tcp
                source-ip: 7.7.7.0/24
                source-port:
                  '80': {}
          '2001':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 7.7.7.0/24
                dest-port:
                  '81': {} 
                protocol: tcp
                source-ip: 7.7.7.0/24
                source-port:
                  '80': {}
          '2002':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 7.7.7.0/24
                dest-port:
                  '80': {} 
                protocol: tcp
                source-ip: 7.7.7.0/24
                source-port:
                  '81': {}
          '2003':
            action:
              deny: {}
            match:
              ip:
                dest-ip: 7.7.7.0/24
                dest-port:
                  '81': {} 
                protocol: tcp
                source-ip: 7.7.7.0/24
                source-port:
                  '81': {}
