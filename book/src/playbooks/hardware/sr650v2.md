# Lenovo SR650 V2 (7Z73)

The Lenovo SR650 V2 (7Z73 variant) is the CPU and storage node for the Azure sites:

* Phase 1: AZ\[01-06], AZ\[20-33]
* Phase 2a: AZ40, AZ50, AZ60

## Helpful Links

* [Maintenanace Manual](https://pubs.lenovo.com/sr650-v2/sr650v2_maintenance_manual.pdf)
* [Driver Downloads](https://datacentersupport.lenovo.com/us/en/products/servers/thinksystem/SR650v2/downloads/driver-list)
* [Product Guide](https://lenovopress.lenovo.com/lp1392.pdf)
* [Lenovo Knowledge Transfer](https://drive.google.com/drive/u/1/folders/1iixkyIMrfw5Y6JNFq5yaAMyd7vM84pVD)

## Inventory

Slot map:

| | | |
|---|---|---|
|Slot|Component|Location|
|4|NVIDIA DPU|Riser 1|

There are two different loadouts for the SR 650 V2 depending on the use-case:

| | | | | | |
|---|---|---|---|---|---|
| Node Type | Vendor | Model | Component | Description | Quantity |
| Cache/CPU | Lenovo | ThinkSystem SR650 V2 OVX | GPU | N/a | 0 |
| example: [J10505TK](https://api-az01.frg.nvidia.com/admin/managed-host/fm100hta83ol6ma7c1fj5ishlmlom8qokbcc2e98l4e1e9gdajk18385k30) | | | DPU | Bluefield 2 | 1 |
| | | | CPU | Intel Platinum 8362 CPU @ 2.80GHz | 2 |
| | | | Memory | 512GB (32GB Sticks) | 16 |
| | | | Disks (boot) | 960GB M2 NVMe SSD | 2 |
| | | | Disks (data) | 1.92TB NVMe SSD | 2 |
| Storage (STG) | Lenovo | ThinkSystem SR650 V2 OVX | GPU | N/a | 0 |
| example: [J105004E](https://api-az01.frg.nvidia.com/admin/managed-host/fm100ht2cjvc1lkrp5844cl7b1rqjqk2618jmda7r72kr7c978l8njlp3p0) | | | DPU | Bluefield 2 | 1 |
| | | | CPU | Intel Platinum 8362 CPU @ 2.80GHz | 2 |
| | | | Memory | 1TB (64GB Sticks) | 16 |
| | | | Disks (boot) | 960GB M2 NVMe SSD | 2 |
| | | | Disks (data) | 1.92TB NVMe SSD | 16 |

## Updating Firmware

Lenovo servers can be finicky about updates so when doing firmware updates follow this advice:

* **Always update XCC before UEFI.** You can go from any version to the latest in one go.
* **Always update UEFI while the system is powered off**
* Lenovo recommends using XCC to apply firmware updates, but [OneCLI](./onecli.md) can also be used.

### Firmware Downloads

| | |
|---|---|
| XCC 5.13 | lnvgy\_fw\_xcc\_afbt50j-5.13\_anyos\_noarch.uxz |
| | [https://datacentersupport.lenovo.com/us/en/downloads/ds571815](https://datacentersupport.lenovo.com/us/en/downloads/ds571815) |
| UEFI 3.31| lnvgy\_fw\_uefi\_afe130d-3.31\_anyos\_32-64.uxz |
| | [https://datacentersupport.lenovo.com/us/en/downloads/ds572288](https://datacentersupport.lenovo.com/us/en/downloads/ds572288) |

## Internal Cabling

The SR650 systems are much less complicated than the GPU nodes, but it is still essential to get cabling correct.

Symptoms of incorrect cabling can include:

* System hang at DXE INIT
* Missing PCIe devices
* PCIe Conn X has encountered a configuration error

The following graphics show how the data cables should route in the system.

For the storage server variant:

<figure>
<img src=../../static/playbooks/hardware/sr650v2_config25a_cabling.png
alt="SR650 V2 storage server cable routing">
</figure>

For the compute variant:

<figure>
<img src=../../static/playbooks/hardware/sr650v2_config21a_cabling.png
alt="SR650 V2 server cable routing">
</figure>

More details can be found in the maintenance manual.

### Backplane

CPU nodes have a single backplane configured while the storage nodes have two backplanes.

CPU node with a single backplane:

<figure>
<img src=../../static/playbooks/hardware/sr650v2_backplane_cabling_cpu.png
alt="SR650 V2 drive backplane cable routing">
</figure>

Storage node with two backplanes:

<figure>
<img src=../../static/playbooks/hardware/sr650v2_backplane_cabling_storage.png
alt="SR650 V2 drive backplane cable routing">
</figure>

### Rear Riser 1 (DPU)

<figure>
<img src=../../static/playbooks/hardware/sr650v2_dpu_data_cables.png
alt="SR650 V2 PCIe riser cable routing">
</figure>
